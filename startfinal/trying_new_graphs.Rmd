---
title: "trying_new_graphs"
output: html_document
---

```{r}
library(tidytext)
library(dplyr)
library(ggplot2)
library(plotly)
library(scales)
```

```{r}
# Ranked list of the most meaningful and common words from all album titles
track_sentiments <- combined_albums_tracks |>
  unnest_tokens(word, track_name) |>
  anti_join(stop_words) |>
  inner_join(get_sentiments("bing")) |> 
  count(word, sentiment, sort = TRUE)

p <- track_sentiments |>
  group_by(sentiment) |>
  top_n(10, n) |>
  ungroup() |>
  mutate(word = reorder(word, n)) |>
  ggplot(aes(word, n, fill = sentiment)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~sentiment, scales = "free_y") +
  coord_flip() +
  labs(title = "Most Common Positive and Negative Words in Track Titles",
       x = NULL, y = "Word Frequency")

ggplotly(p)
```


```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(plotly)

# Example genre input
selected_genre <- "pop"

# Step 1: Separate genres into individual rows
long_genres <- combined_artists_tracks %>%
  separate_rows(genres, sep = ", ")

# Filter tracks for genres that contain the selected keyword
genre_tracks <- long_genres %>%
  filter(grepl(selected_genre, genres, ignore.case = TRUE))

track_level_df <- genre_tracks %>%
  distinct(charted_year, genres, track_name, artist_name)

p <- ggplot(track_level_df, aes(x = charted_year, y = genres,
                                text = paste0(
                                  "Track: ", track_name,
                                  "\nArtist: ", artist_name,
                                  "\nGenre: ", genres,
                                  "\nCharted Year: ", charted_year))) +
  geom_jitter(width = 0.2, height = 0.2, color = "#1DB954", alpha = 0.7, size = 3) +
  labs(
    title = paste0("Tracks with '", selected_genre, "' Genres (2018â€“2024)"),
    x = "Charted Year",
    y = "Genre"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_rect(fill = "black"),
    panel.background = element_rect(fill = "black"),
    panel.grid.major = element_line(color = "gray30"),
    panel.grid.minor = element_line(color = "gray20"),
    plot.title = element_text(face = "bold", color = "white"),
    axis.title = element_text(color = "white"),
    axis.text = element_text(color = "white"),
    axis.ticks = element_line(color = "white")
  )

ggplotly(p, tooltip = "text")
```



# Compare years since release by artist
```{r}
p <- combined_artists_tracks |>
  filter(artist_name == "Taylor Swift") |>
  ggplot(aes(
    x = years_since_release,
    y = popularity,
    color = track_name,
    text = paste(
      "Track: ", track_name,
      "<br>Popularity: ", popularity,
      "<br>Years Since Release: ", years_since_release,
      "<br>Charted Year: ", charted_year,
      "<br>Release Year: ", release_year
    )
  )) +
  geom_point(size = 3, alpha = 0.7) +
  labs(
    title = "Taylor Swift: Track Popularity vs. Years Since Release",
    x = "Years Since Release",
    y = "Popularity",
    color = "Track Name"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

ggplotly(p, tooltip = "text")
```


```{r}
# Get list of unique album names
album_choices <- unique(new_releases_combined$album_name)

# Default album selection
selected_album <- album_choices[1]

# Filter the data
filtered_data <- new_releases_combined %>%
  filter(album_name == selected_album)

# Create the plot
a <- ggplot(filtered_data, aes(x = track_name, y = popularity, 
                               text = paste("Track:", track_name,
                                            "<br>Popularity:", popularity,
                                            "<br>Explicit:", track_explicit))) +
  geom_col(fill = "steelblue") +
  labs(title = paste("Track Popularity -", selected_album),
       x = "Track Name", y = "Popularity") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Convert to plotly with tooltip
ggplotly(a, tooltip = "text")

```


